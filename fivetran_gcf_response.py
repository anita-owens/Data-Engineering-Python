request = {
  "state": "2023-03-31",
  "schema": {
    "businesses": { "primary_key": ["id"] },
    "business_category": {}
  },
  "insert": {
    "businesses": [
      {
        "id": "n15oXwQrw-auysdyJRNRdQ",
        "alias": "craftsman-ave-brooklyn",
        "name": "Craftsman Ave",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sti6h8RfvzWVl67A2_7zzg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/craftsman-ave-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 26,
        "rating": 5.0,
        "phone": "+19292669513",
        "display_phone": "(929) 266-9513",
        "distance": 4199.685346303878,
        "address1": "117B 11th St",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.67118914804501,
        "longitude": -73.99370157874307
      },
      {
        "id": "qMliTBq4THX_ft0sq7eVaQ",
        "alias": "fabberz-brooklyn",
        "name": "FABberz",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/Af1_GUDPq2_sEvmRVqodyQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/fabberz-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 16,
        "rating": 4.5,
        "phone": "+16467819448",
        "display_phone": "(646) 781-9448",
        "distance": 6109.714365499711,
        "address1": "68 35th St",
        "address2": "Ste C548",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11232",
        "country": "US",
        "state": "NY",
        "latitude": 40.6566677,
        "longitude": -74.0071976
      },
      {
        "id": "xzMHYrCUBIdOAmDRXsC95Q",
        "alias": "shopify-ny-new-york",
        "name": "Shopify NY",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/CSdzVD4-FoE9G_445m3iQA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/shopify-ny-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 3,
        "rating": 4.5,
        "phone": "",
        "display_phone": "",
        "distance": 2661.3571391746586,
        "address1": "131 Greene St",
        "address2": "",
        "address3": "null",
        "city": "New York",
        "zip_code": "10012",
        "country": "US",
        "state": "NY",
        "latitude": 40.725702373539676,
        "longitude": -73.99904183097088
      },
      {
        "id": "ergj2tzWj3H2-pmWMcbx1w",
        "alias": "b-x-space-to-create-brooklyn",
        "name": "b[x] spaces",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/5CJxVIlEWCSUD8XzP4autg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 5,
        "rating": 4.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4556.3706602622315,
        "address1": "203 Harrison Pl",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.7075341790915,
        "longitude": -73.9249071478844
      },
      {
        "id": "0Dt9oY9EQyVh1gC05-X92A",
        "alias": "b-x-space-to-create-brooklyn-3",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/_lmQNlXSbmtCXweTvUNKMQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-3?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 1,
        "rating": 5.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4525.46036055991,
        "address1": "44 Stewart Ave",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70762,
        "longitude": -73.92533
      },
      {
        "id": "iPLFuje1Q-S2Gu4ejDRUuA",
        "alias": "makeville-studio-new-york",
        "name": "Makeville Studio",
        "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/m42hdnSr87oiiBawnSH_Zw/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/makeville-studio-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 7,
        "rating": 2.5,
        "phone": "+19178735542",
        "display_phone": "(917) 873-5542",
        "distance": 3961.8053201973353,
        "address1": "125 8th St",
        "address2": "",
        "address3": "",
        "city": "New York",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.6728763,
        "longitude": -73.9912536
      },
      {
        "id": "hhE0iUTPGXyjsTnV4C2RIA",
        "alias": "whymaker-new-york",
        "name": "WhyMaker",
        "image_url": "",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/whymaker-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19178197439",
        "display_phone": "(917) 819-7439",
        "distance": 5753.237361558075,
        "address1": "909 Third Ave",
        "address2": "null",
        "address3": "",
        "city": "New York",
        "zip_code": "10022",
        "country": "US",
        "state": "NY",
        "latitude": 40.7583,
        "longitude": -73.9679
      },
      {
        "id": "xaUCjQQvEY4p9hHfqGEo3w",
        "alias": "b-x-space-to-create-brooklyn-2",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sMmG9fhfvurtN1HYMNGvEQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-2?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4570.331593100502,
        "address1": "362 Jefferson St",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70568,
        "longitude": -73.92477
      },
      {
        "id": "cymvUYah0M0e6RnU_tHq6Q",
        "alias": "techahoy-queens",
        "name": "TechAhoy",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/iVdaAXWOmk0YsoMtP_M_oA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/techahoy-queens?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19179942441",
        "display_phone": "(917) 994-2441",
        "distance": 6375.677770368756,
        "address1": "801 Woodward Ave",
        "address2": "",
        "address3": "null",
        "city": "Queens",
        "zip_code": "11385",
        "country": "US",
        "state": "NY",
        "latitude": 40.703544044276,
        "longitude": -73.9034425323672
      }
    ],
    "business_category": [
      { "alias": "artclasses", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "makerspaces", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "engraving", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "productdesign", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "xzMHYrCUBIdOAmDRXsC95Q" },
      { "alias": "sharedofficespaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "galleries", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "makerspaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "sharedofficespaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "galleries", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "iPLFuje1Q-S2Gu4ejDRUuA" },
      { "alias": "educationservices", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "highschools", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "makerspaces", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "sharedofficespaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "galleries", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "cymvUYah0M0e6RnU_tHq6Q" }
    ]
  },
  "hasMore": "false"
}


print(request.keys())
##Scenario 1 State in request is populated with '2023-03-31'
#Returns 2023-03-31
if not request["state"]:
    state = '2022-09-01'
else:
    state = request["state"]
print(state)

##Scenario 2. State in request populated with '2022-09-01'. Returns 2022-09-01.
request2 = {
  "state": "2022-09-01",
  "schema": {
    "businesses": { "primary_key": ["id"] },
    "business_category": {}
  },
  "insert": {
    "businesses": [
      {
        "id": "n15oXwQrw-auysdyJRNRdQ",
        "alias": "craftsman-ave-brooklyn",
        "name": "Craftsman Ave",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sti6h8RfvzWVl67A2_7zzg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/craftsman-ave-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 26,
        "rating": 5.0,
        "phone": "+19292669513",
        "display_phone": "(929) 266-9513",
        "distance": 4199.685346303878,
        "address1": "117B 11th St",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.67118914804501,
        "longitude": -73.99370157874307
      },
      {
        "id": "qMliTBq4THX_ft0sq7eVaQ",
        "alias": "fabberz-brooklyn",
        "name": "FABberz",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/Af1_GUDPq2_sEvmRVqodyQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/fabberz-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 16,
        "rating": 4.5,
        "phone": "+16467819448",
        "display_phone": "(646) 781-9448",
        "distance": 6109.714365499711,
        "address1": "68 35th St",
        "address2": "Ste C548",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11232",
        "country": "US",
        "state": "NY",
        "latitude": 40.6566677,
        "longitude": -74.0071976
      },
      {
        "id": "xzMHYrCUBIdOAmDRXsC95Q",
        "alias": "shopify-ny-new-york",
        "name": "Shopify NY",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/CSdzVD4-FoE9G_445m3iQA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/shopify-ny-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 3,
        "rating": 4.5,
        "phone": "",
        "display_phone": "",
        "distance": 2661.3571391746586,
        "address1": "131 Greene St",
        "address2": "",
        "address3": "null",
        "city": "New York",
        "zip_code": "10012",
        "country": "US",
        "state": "NY",
        "latitude": 40.725702373539676,
        "longitude": -73.99904183097088
      },
      {
        "id": "ergj2tzWj3H2-pmWMcbx1w",
        "alias": "b-x-space-to-create-brooklyn",
        "name": "b[x] spaces",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/5CJxVIlEWCSUD8XzP4autg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 5,
        "rating": 4.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4556.3706602622315,
        "address1": "203 Harrison Pl",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.7075341790915,
        "longitude": -73.9249071478844
      },
      {
        "id": "0Dt9oY9EQyVh1gC05-X92A",
        "alias": "b-x-space-to-create-brooklyn-3",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/_lmQNlXSbmtCXweTvUNKMQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-3?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 1,
        "rating": 5.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4525.46036055991,
        "address1": "44 Stewart Ave",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70762,
        "longitude": -73.92533
      },
      {
        "id": "iPLFuje1Q-S2Gu4ejDRUuA",
        "alias": "makeville-studio-new-york",
        "name": "Makeville Studio",
        "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/m42hdnSr87oiiBawnSH_Zw/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/makeville-studio-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 7,
        "rating": 2.5,
        "phone": "+19178735542",
        "display_phone": "(917) 873-5542",
        "distance": 3961.8053201973353,
        "address1": "125 8th St",
        "address2": "",
        "address3": "",
        "city": "New York",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.6728763,
        "longitude": -73.9912536
      },
      {
        "id": "hhE0iUTPGXyjsTnV4C2RIA",
        "alias": "whymaker-new-york",
        "name": "WhyMaker",
        "image_url": "",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/whymaker-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19178197439",
        "display_phone": "(917) 819-7439",
        "distance": 5753.237361558075,
        "address1": "909 Third Ave",
        "address2": "null",
        "address3": "",
        "city": "New York",
        "zip_code": "10022",
        "country": "US",
        "state": "NY",
        "latitude": 40.7583,
        "longitude": -73.9679
      },
      {
        "id": "xaUCjQQvEY4p9hHfqGEo3w",
        "alias": "b-x-space-to-create-brooklyn-2",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sMmG9fhfvurtN1HYMNGvEQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-2?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4570.331593100502,
        "address1": "362 Jefferson St",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70568,
        "longitude": -73.92477
      },
      {
        "id": "cymvUYah0M0e6RnU_tHq6Q",
        "alias": "techahoy-queens",
        "name": "TechAhoy",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/iVdaAXWOmk0YsoMtP_M_oA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/techahoy-queens?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19179942441",
        "display_phone": "(917) 994-2441",
        "distance": 6375.677770368756,
        "address1": "801 Woodward Ave",
        "address2": "",
        "address3": "null",
        "city": "Queens",
        "zip_code": "11385",
        "country": "US",
        "state": "NY",
        "latitude": 40.703544044276,
        "longitude": -73.9034425323672
      }
    ],
    "business_category": [
      { "alias": "artclasses", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "makerspaces", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "engraving", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "productdesign", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "xzMHYrCUBIdOAmDRXsC95Q" },
      { "alias": "sharedofficespaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "galleries", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "makerspaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "sharedofficespaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "galleries", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "iPLFuje1Q-S2Gu4ejDRUuA" },
      { "alias": "educationservices", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "highschools", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "makerspaces", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "sharedofficespaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "galleries", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "cymvUYah0M0e6RnU_tHq6Q" }
    ]
  },
  "hasMore": "false"
}

if not request2["state"]:
    state = '2022-09-01'
else:
    state = request2["state"]
print(state)

#Empty state. Fallback value is returned 2022-09-01
request3 = {
  "state": "",
  "schema": {
    "businesses": { "primary_key": ["id"] },
    "business_category": {}
  },
  "insert": {
    "businesses": [
      {
        "id": "n15oXwQrw-auysdyJRNRdQ",
        "alias": "craftsman-ave-brooklyn",
        "name": "Craftsman Ave",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sti6h8RfvzWVl67A2_7zzg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/craftsman-ave-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 26,
        "rating": 5.0,
        "phone": "+19292669513",
        "display_phone": "(929) 266-9513",
        "distance": 4199.685346303878,
        "address1": "117B 11th St",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.67118914804501,
        "longitude": -73.99370157874307
      },
      {
        "id": "qMliTBq4THX_ft0sq7eVaQ",
        "alias": "fabberz-brooklyn",
        "name": "FABberz",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/Af1_GUDPq2_sEvmRVqodyQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/fabberz-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 16,
        "rating": 4.5,
        "phone": "+16467819448",
        "display_phone": "(646) 781-9448",
        "distance": 6109.714365499711,
        "address1": "68 35th St",
        "address2": "Ste C548",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11232",
        "country": "US",
        "state": "NY",
        "latitude": 40.6566677,
        "longitude": -74.0071976
      },
      {
        "id": "xzMHYrCUBIdOAmDRXsC95Q",
        "alias": "shopify-ny-new-york",
        "name": "Shopify NY",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/CSdzVD4-FoE9G_445m3iQA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/shopify-ny-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 3,
        "rating": 4.5,
        "phone": "",
        "display_phone": "",
        "distance": 2661.3571391746586,
        "address1": "131 Greene St",
        "address2": "",
        "address3": "null",
        "city": "New York",
        "zip_code": "10012",
        "country": "US",
        "state": "NY",
        "latitude": 40.725702373539676,
        "longitude": -73.99904183097088
      },
      {
        "id": "ergj2tzWj3H2-pmWMcbx1w",
        "alias": "b-x-space-to-create-brooklyn",
        "name": "b[x] spaces",
        "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/5CJxVIlEWCSUD8XzP4autg/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 5,
        "rating": 4.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4556.3706602622315,
        "address1": "203 Harrison Pl",
        "address2": "null",
        "address3": "",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.7075341790915,
        "longitude": -73.9249071478844
      },
      {
        "id": "0Dt9oY9EQyVh1gC05-X92A",
        "alias": "b-x-space-to-create-brooklyn-3",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/_lmQNlXSbmtCXweTvUNKMQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-3?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 1,
        "rating": 5.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4525.46036055991,
        "address1": "44 Stewart Ave",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70762,
        "longitude": -73.92533
      },
      {
        "id": "iPLFuje1Q-S2Gu4ejDRUuA",
        "alias": "makeville-studio-new-york",
        "name": "Makeville Studio",
        "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/m42hdnSr87oiiBawnSH_Zw/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/makeville-studio-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 7,
        "rating": 2.5,
        "phone": "+19178735542",
        "display_phone": "(917) 873-5542",
        "distance": 3961.8053201973353,
        "address1": "125 8th St",
        "address2": "",
        "address3": "",
        "city": "New York",
        "zip_code": "11215",
        "country": "US",
        "state": "NY",
        "latitude": 40.6728763,
        "longitude": -73.9912536
      },
      {
        "id": "hhE0iUTPGXyjsTnV4C2RIA",
        "alias": "whymaker-new-york",
        "name": "WhyMaker",
        "image_url": "",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/whymaker-new-york?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19178197439",
        "display_phone": "(917) 819-7439",
        "distance": 5753.237361558075,
        "address1": "909 Third Ave",
        "address2": "null",
        "address3": "",
        "city": "New York",
        "zip_code": "10022",
        "country": "US",
        "state": "NY",
        "latitude": 40.7583,
        "longitude": -73.9679
      },
      {
        "id": "xaUCjQQvEY4p9hHfqGEo3w",
        "alias": "b-x-space-to-create-brooklyn-2",
        "name": "b[x] - space to create",
        "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/sMmG9fhfvurtN1HYMNGvEQ/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/b-x-space-to-create-brooklyn-2?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+13477628588",
        "display_phone": "(347) 762-8588",
        "distance": 4570.331593100502,
        "address1": "362 Jefferson St",
        "address2": "",
        "address3": "null",
        "city": "Brooklyn",
        "zip_code": "11237",
        "country": "US",
        "state": "NY",
        "latitude": 40.70568,
        "longitude": -73.92477
      },
      {
        "id": "cymvUYah0M0e6RnU_tHq6Q",
        "alias": "techahoy-queens",
        "name": "TechAhoy",
        "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/iVdaAXWOmk0YsoMtP_M_oA/o.jpg",
        "is_closed": "false",
        "url": "https://www.yelp.com/biz/techahoy-queens?adjust_creative=rdtjBtOkzZQE7_XzbAcBmQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=rdtjBtOkzZQE7_XzbAcBmQ",
        "review_count": 0,
        "rating": 0.0,
        "phone": "+19179942441",
        "display_phone": "(917) 994-2441",
        "distance": 6375.677770368756,
        "address1": "801 Woodward Ave",
        "address2": "",
        "address3": "null",
        "city": "Queens",
        "zip_code": "11385",
        "country": "US",
        "state": "NY",
        "latitude": 40.703544044276,
        "longitude": -73.9034425323672
      }
    ],
    "business_category": [
      { "alias": "artclasses", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "makerspaces", "id": "n15oXwQrw-auysdyJRNRdQ" },
      { "alias": "engraving", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "productdesign", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "qMliTBq4THX_ft0sq7eVaQ" },
      { "alias": "makerspaces", "id": "xzMHYrCUBIdOAmDRXsC95Q" },
      { "alias": "sharedofficespaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "galleries", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "makerspaces", "id": "ergj2tzWj3H2-pmWMcbx1w" },
      { "alias": "sharedofficespaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "galleries", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "0Dt9oY9EQyVh1gC05-X92A" },
      { "alias": "makerspaces", "id": "iPLFuje1Q-S2Gu4ejDRUuA" },
      { "alias": "educationservices", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "highschools", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "makerspaces", "id": "hhE0iUTPGXyjsTnV4C2RIA" },
      { "alias": "sharedofficespaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "galleries", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "xaUCjQQvEY4p9hHfqGEo3w" },
      { "alias": "makerspaces", "id": "cymvUYah0M0e6RnU_tHq6Q" }
    ]
  },
  "hasMore": "false"
}

if not request3["state"]:
    state = '2022-09-01'
else:
    state = request3["state"]
print(state)


#The state object contains a key-value pair
#Returns 2023-04-02T00:00:01Z
connector_response = {
    "state": {
        "since_id": "2023-04-02T00:00:01Z"
    },
    "insert": {
        "table_name": [
            {"id":1, "value": 100}]
    },
    "delete": {},
    "schema" : {
        "table_name": {
            "primary_key": ["id"]
        }
    },
    "has_more" : 'true'
}

if not connector_response["state"]:
    state = '2022-09-01'
else:
    state = connector_response["state"]["since_id"]
print(state)

#State is blank
connector_response = {
    "state": {
        
    },
    "insert": {
        "table_name": [
            {"id":1, "value": 100}]
    },
    "delete": {},
    "schema" : {
        "table_name": {
            "primary_key": ["id"]
        }
    },
    "has_more" : 'true'
}

if not connector_response["state"]:
    state = '2023-01-01'
else:
    state = connector_response["state"]["since_id"]
print(state)